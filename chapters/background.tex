\chapter{The scenario}
\label{cha:scenario}
%\textit{Detailed explanation of the problem and its scope: starting from a practical description, a formalization of the entities involved and what they want to achieve. 2 examples (deliveries with couriers and port exchanges). Then, the intentions of the company I have worked for.}

This chapter introduces the problem, giving a more detailed description. In fact, we have only given a few examples in the Abstract, but we need a precise model of the use case. Then we focus on decentralization, explaining what are the main characteristics of such approach and defining some concepts.

\section{Problem statement and solution architecture}
\label{sec:statement}
Formalizing the problem, the typical scenario is the following. We have a sender \textit{S} and a final recipient \textit{R}. \textit{S} wants to send \textit{R} a particular good, \textit{G}. To perform the exchange, \textit{S} will designate a certain route that involves \textit{n} intermediate stops ($I_1, I_2, ..., I_n$) and will instruct \textit{m} dealers ($D_1, D_2, ..., D_m$) that will take care of each part of the delivery. From a theoretical point of view, nothing forbids to have two identical dealers $D_i$ - $D_j$. Indeed, as we will see later, we are not really interested in the dealers themselves, but more in the companies that these dealers work for. We assume that \textit{S} decides the route or, at least, knows the various stops needed.

We would like to find a model able to register precisely each handover, by making use of secure techniques that do not allow counterfeiting or fraud: each entity should be protected against a potential malicious one. Finally, \textit{R} should be able to monitor the events about \textit{G}, in order to check the progresses.

The proposed solution will make use of IoT devices to track the location of the dealers. Additionally, we will define a protocol to use the connectivity of these trackers to detect other devices owned by the intermediate points. In this way, the verification will be automatized and, from the human point of view, we will only need a little expedient from the dealers. Furthermore, the architecture will not present any centralized element: the solution will be fully decentralized.

\section{Decentralization}
\label{sec:decentralization}
%\textit{Why decentralization can be the solution, how it differs from a traditional approach. The blockchain, with its hype, as a valid alternative. Deep explanation of what it is etc.}

Unlike traditional architectures, that usually present a single element providing all the information for the service and practically having control, a typical distributed network shares knowledge between many nodes, therefore excluding a central point.

Centralization versus decentralization is a battle that does not have a definite winner. The Internet has seen several attempts to decentralize some services, like DNS and social networks, but the truth is that, in many situations, the benefits of keeping a central entity often outperform those of the correspondent distributed alternatives~\cite{Montresor_Permissionless}. However, there are still some cases in which a P2P network is a valid solution, especially when there are hard requirements like privacy, anti-censorship and scalability. Despite their advantages, in fact, centralized architectures always present a single point of failure, with all its consequences.

When in 2008 the mysterious Satoshi Nakamoto published the Bitcoin paper~\cite{bitcoin}, a particular type of distributed network became extremely popular: the \emph{blockchain}. The author proposed ``a purely peer-to-peer version of electronic cash'', with the aim of introducing a payment system based on a crypto-currency, without intermediaries but still reliable and secure against typical attacks such as double spending. This problem may arise for two reasons. The first is that crypto-currencies have no watermarks to prevent the unauthorized production of money: consequently, it is in principle possible to copy one coin and spend it twice. The second is a direct disadvantage of a distributed system: propagation delays have to be handled in order to correctly distinct and validate the correct transactions. More generally, distributed networks need to implement a protocol to establish consensus between nodes.
Bitcoin combines existing technologies in a sophisticated way, to solve its fundamental problems. Without examining in depth all these mechanisms, let us concentrate on how transactions are stored: using a blockchain.

The blockchain itself is just a distributed data structure: as the name suggests, it is composed by blocks and each block contains transactions. These transactions are defined with a precise grammar, that obviously depends on the type of application. In Bitcoin, for example, transactions respect the (simplified) form ``the result of transaction $T_i$ is used as input to send $x$ BTC to $A$, with fee $y$'', where $A$ is the public key of the recipient. Beyond the grammar, to implement a blockchain there is the need of a function to validate transactions. Evidently, the previous sample transaction will be refused, if the sender does not have the rights to use the output of $T_i$. More precisely, Bitcoin uses a measure called proof-of-work, in order to not only include a control on the actual validity of the transactions, but also to require a strong computational effort to approve a block. This is a crucial element to improve reliability and contrast the possibility of subverting the network with sybil attacks.

What makes the blockchain different from other data structures are two properties. First, it is distributed: every node of the network has its own copy of a \emph{ledger}, that is kept consistent and up to date with gossip protocols. Second, the way in which these blocks are linked: each one contains the hash fingerprint of the previous. As a result of these, once data is inserted in a block it impossible to change it. In practice, changing a transaction would mean recalculating the hash value of all the blocks succeeding the modified one, replacing the fingerprint and convincing all the network that the new copy is the one that should be used. This is impossible, unless one controls more than half of the overall computing power. Immutability is the first and fundamental property of the blockchain, that makes it a good solution to store money exchanges: obviously, crypto-currency designers do not want to allow the possibility of modifying any of the validated transactions.

The Bitcoin system showed the world the great potential of the blockchain. After its success, a number of other similar crypto-currencies were launched, with the so-called \emph{initial coin offerings}, generating a new business for investors and speculators. A lot of hype is still surrounding this technology, that in any case presents some disadvantages and it is surely not the right solution for every problem~\cite{noblockchain}. 

Analyzing again our case, however, it seems to suit well. Handovers can correspond to the transactions, the goods can be our ``coins'' and the entities of the system can be the participants of the network, submitting exchanges. Essential requirements such as reliability and durability of transactions would be guaranteed by design. In Chapter~\ref{sec:arch} we discuss better this approach.

