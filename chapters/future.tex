\chapter{Testing and future developments}
\label{cha:future}

In the previous chapters we have explained how we modelled our solution. The result is an abstract architecture that still presents some points that need to be defined. To do so, some real requirements, coming from a client, need to be included. As it has been presented, the project is only a ``proof-of-concept'', that can represent a good base for an extended version adapted to a more specific use case.

\textsc{Spindox} usually builds custom services, hence the team was not interested in developing an entire platform to be used to ensure certain properties (such as, for example, the payment processor ``PayPal''). Instead, the company wanted to explore the blockchain environment and understand, through the elaboration of this project, what are its benefits and drawbacks. 

Our team only tested it in a local environment. Hyperledger offers wide support with its tools, that allowed us to test the network concretely simulating a deployed version. In particular, Composer provides a simple but still complete interface to work with the REST API available and develop the other elements on top of them. Passing from Composer to real Fabric, however, is not trivial and requires a thorough configuration of the various machines involved. The peers need to be deployed with respect to the specific use case: how to scale them correctly depends on the final requirements. In any case, we have given in \ref{sec:fabric_structure} some general insights that need to be followed to guarantee a well distributed system. Also the consensus protocols has not been chosen in our project: Hyperledger provides some good built-in alternatives and we mentioned an external one too. Concerning the latter, though, the integration might be quite complicated.

\section{Limits}
Hyperledger is a valuable solution that includes not only the properties of the blockchain, but also the ease of use and extensibility necessary to build a private network. The framework allowed us to build a system operating effectively, also with the integration of the various interfaces and the IoT devices. However, the presence of an immutable ledger has negatives too. The trackers may generate a high number of messages, some of them unnecessary, and the server, managing them, will occasionally send false positive transactions. This is not, as a matter of principle, a problem: if the dealer tries to complete the delivery, but for some reason they do not succeed, this should be reported. Anyway, if a confirmation is sent only on the dealer's side, the system will be in an inconsistent state. A final receiver who checks the updates exactly in that moment might worry for no real reason. To solve this, we could implement some sort of ``garbage collector'' for these transactions, but it is impossible by design to delete entries from the blockchain. As a result, the only countermeasure is to program in the best way possible the servers and the firmware of the devices, to reduce this issue at the minimum.

Also considering the framework itself, Hyperledger has some shortcomings. For instance, the fact that smart contracts can be written in a general purpose language is a potential risk, since the security that a DSL would provide is not guaranteed. It can be argued that, since an error in such programs can cost millions of dollars, the language should be safe by design. In addition, writing code for Hyperledger is not very easy and user-friendly: the classic ``Hello world'' program can require a significant number of rows. As recognized by both industry and academia, more code means more bugs.

All the communications using HTTP can be secured by including the TLS layer. Organizations in Fabric have their CAs by default, set up together with the network, while public accessible interfaces should implement certificates as well. On the other hand, MQTT is, by default, a vulnerable protocol, since messages are sent in clear. Unfortunately, the IoT hype makes developers often forget about security, but there are some measures that can be applied to guarantee a secure layer. In every case, though, some overhead is included and inevitably this worsens the MQTT performances.

\section{Extensions}
The current solution have surely some extensions that can be included. In this section we will point out a couple of them.

First of all, we did not include any additional use of the IoT trackers updates. Since the servers receive continuously the dealers' location, the companies could build an internal system for vehicles tracking. Alternatively, an extension of the blockchain network logic could add transactions that update the assets with their current location, not only at exchange points. This adds no special value, compared to already existing solutions: the receiver would have to trust a single organization (the dealer's), exactly as happens nowadays with the tracking platforms exposed by almost every logistic company. Nonetheless, it can still represent a remarkable feature.

Another aspect that could be handled more smoothly is the other type of handover occurring in our use case: with this version only the ``arrival'' of a good at an intermediate point is tracked, while the confirmations of exchange for the following part of the route are not registered. Referencing Figure \ref{fig:solution}, for example, only the handover from $D_1$ to the employee in $I_1$ is written on the blockchain, hence when $G$ is being delivered by $D_2$ towards $I_2$ the final recipient has not been informed. Such extension could be implemented by enabling an additional operation from the interface offered to intermediate points, but it should not be open to any attack from a malicious employee. Integrate!

%\textit{About what has been done, how it works. About what still needs to be developed: how to scale correctly the network, how to sell it. The proposed solution is more an "interface", a proof-of-concept. It can represent a good starting base for a custom project, responding to a client's needs. The company won't send the product as a whole, but more likely an ad hoc service. Some logistic companies already showed interest. Limits of the system as it is now: in its current shape, it is similar to a service like "Paypal", so a secure layer quite complicated and not perfect. Possible extensions: sending updated with the coordinates of the good, tracking more exchanges (e.g. not only the arrival of the good at a certain point, but the departure too)}